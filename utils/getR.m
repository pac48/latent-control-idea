function R = getR(rpy)
rpy = reshape(rpy, 3, 1, []);
ct = cos(rpy);
st = sin(rpy);
R11 = ct(1, :, :).*ct(3, :, :).*ct(2, :, :) - st(1, :, :).*st(3, :, :);
R12 = -ct(1, :, :).*ct(2, :, :).*st(3, :, :) - st(1, :, :).*ct(3, :, :);
R13 = ct(1, :, :).*st(2, :, :);
R21 = st(1, :, :).*ct(3, :, :).*ct(2, :, :) + ct(1, :, :).*st(3, :, :);
R22 = -st(1, :, :).*ct(2, :, :).*st(3, :, :) + ct(1, :, :).*ct(3, :, :);
R23 = st(1, :, :).*st(2, :, :);
R31 = -st(2, :, :).*ct(3, :, :);
R32 = st(2, :, :).*st(3, :, :);
R33 = ct(2, :, :);

%             T = [R11 R12 R13 p(1)
%                 R21 R22 R23 p(2)
%                 R31 R32 R33 p(3)
%                 0   0   0   1];
R1 = cat(2, R11, R12, R13);
R2 = cat(2, R21, R22, R23);
R3 = cat(2, R31, R32, R33);
R = cat(1, R1, R2, R3);
%             R = [R11, R12, R13
%                 R21, R22, R23
%                 R31, R32, R33];
end